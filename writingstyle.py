# -*- coding: utf-8 -*-
"""WritingStyle.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1aHetfDLtIaI10CY877WJKBfghNyBVZR8
"""

import nltk
from nltk.tokenize import word_tokenize,sent_tokenize
from nltk.corpus import stopwords
nltk.download('punkt')

from urllib.request import urlopen
# we need to wrangle this HTML to extract the required data
# import BeatifulSoup to conver tag soup in HTML to useful text
from bs4 import BeautifulSoup as BS

"""## Writing Styles Analysis

### Basic feature extraction using text data
>Number of words
<br>Number of characters
<br>Average word length
<br>Number of stopwords
<br>Number of special characters
<br>Number of numerics
<br>Number of uppercase words

Functions to find number of sentences and words in text
"""

def article_sentlength(content):
  s_tokens = sent_tokenize(content)
  return len(s_tokens)

def article_wordlength(content):
  w_tokens = word_tokenize(content)
  return len(w_tokens)

"""Function to calculate avg no. of words in each sentence"""

def avg_wordcount(content):
  avg = article_wordlength(content)/article_sentlength(content)
  return avg

"""Function to calculate average word length in each sentence"""

def avg_sent_word(content):
  s_tokens = sent_tokenize(content)
  for index in range(len(s_tokens)):
    char_ct = 0
    for word in s_tokens[index].split():
      char_ct+= len(word)
    print('Sentence ',index+1,': ',char_ct/len(s_tokens[index].split()))

"""Function to find no. of stopwords in each sentence """

stop = stopwords.words('english')
def calc_stopwords(content):
  sent_full = sent_tokenize(content)
  sent_no = 0
  for sent in sent_full:
    stop_ct = 0
    for word in sent.split():
      if word in stop:
        stop_ct+=1
    sent_no+=1
    print('Sentence ',sent_no+1,', No. of stopwords: ',stop_ct)

"""Function to find any digits in any sentences, if so - how many sentences?
<br> This function will only show words that are completely digits. Words that are a combination of symbols/alphabets and digits will not be recognised by this function and this is why further processing such as removal of punctuation and/or symbols is required
"""

def find_digs(content):
  sent_full = sent_tokenize(content)
  sent_no = 0
  for sent in sent_full:
    dig_ct = 0
    for word in sent.split():
      if word.isdigit():
        dig_ct+=1
        print('Sentence ',sent_no+1,' No. of numerical data: ',dig_ct)
        print(word)
    sent_no+=1

"""Function to find words in uppercase - such words in texts could indicate excitement, importance or anger"""

def uppercase(content):
  sent_full = sent_tokenize(content)
  upper = []
  caps = []
  for i in range(len(sent_full)):
    words = sent_full[i].split()
    for j in range(len(words)):
      if words[j].isupper():
        string = 'Sentence '+str(i+1)+': '+words[j]
        upper.append(string)
      if words[j][0].isupper():
        string = 'Sentence '+str(i+1)+': '+words[j]
        caps.append(string)
  print('UPPERCASE')
  for item in upper:
    print(item)
  print('CAPITALISED')
  for item in caps:
    print(item)

"""### Hardwarezone Article #1 
<br> **Title**: Zephyr Pro gaming mouse review: Built-in fan keeps you cool
"""

url1 = 'https://www.hardwarezone.com.sg/review-zephyr-pro-gaming-mouse'

html = urlopen(url1).read()

soup = BS(html,"html5lib")
type(soup)

soup.title

#script.decompose testing
for script in soup(["script", "style"]):
    script.decompose()
#strips = list(soup.stripped_strings)
#print(strips)
print(' '.join(soup.stripped_strings))

article = soup.find_all("p")#, class_="page_title")
for div in article:
  print(div)

invalid_tags = ['img','a','strong','em']
for tag in invalid_tags: 
  for match in soup.findAll(tag):
    match.replaceWithChildren()

article = soup.find_all("p")#, class_="page_title")
main_content_hwz1 = []
# for div in article:
#   print(div)
for tag in article:
  for p_child in tag.children:
    main_content_hwz1.append(p_child)

main_content_hwz1 = ' '.join(main_content_hwz1)
print(main_content_hwz1)

# Number of sentences in article
print('No. of sentences in this article: ',article_sentlength(main_content_hwz1))
# Number of words in article
print('No. of words in this article: ',article_wordlength(main_content_hwz1))

print('Average number of words in a sentence: ',avg_wordcount(main_content_hwz1))

print('Average word length in each sentence: ')
avg_sent_word(main_content_hwz1)

print('No. of stopwords in each sentence: ')
calc_stopwords(main_content_hwz1)

print('No. of numerical words in each sentence: ')
find_digs(main_content_hwz1)

print('Capitalised / Uppercase words')
uppercase(main_content_hwz1)

"""### Hardwarezone Article #2
<br> **Title**: Apple’s third-generation AirPods features spatial audio, longer battery life, and reimagined design (Updated)
"""

url2 = 'https://www.hardwarezone.com.sg/tech-news-apple-third-generation-airpods-3-2021-pricing-availability-singapore-pre-order'

html = urlopen(url2).read()

soup = BS(html,"html5lib")
type(soup)

soup.title

print(soup)

#script.decompose testing
for script in soup(["script", "style"]):
    script.decompose()
#strips = list(soup.stripped_strings)
#print(strips)
print(' '.join(soup.stripped_strings))

article = soup.find_all("p")#, class_="page_title")
for div in article:
  print(div)

invalid_tags = ['img','a','strong','em','s']
for tag in invalid_tags: 
  for match in soup.findAll(tag):
    match.replaceWithChildren()

article = soup.find_all("p")#, class_="page_title")
main_content_hwz2 = []
for tag in article:
  for p_child in tag.children:
    main_content_hwz2.append(p_child)

print(main_content_hwz2)

main_content_hwz2 = ' '.join(main_content_hwz2)
print(main_content_hwz2)

# Number of sentences in article
print('No. of sentences in this article: ',article_sentlength(main_content_hwz2))
# Number of words in article
print('No. of words in this article: ',article_wordlength(main_content_hwz2))

print('Average number of words in a sentence: ',avg_wordcount(main_content_hwz2))

print('Average word length in each sentence: ')
avg_sent_word(main_content_hwz2)

print('No. of stopwords in each sentence: ')
calc_stopwords(main_content_hwz2)

print('No. of numerical words in each sentence: ')
find_digs(main_content_hwz2)

print('Capitalised / Uppercase words')
uppercase(main_content_hwz2)

"""### Channel News Asia (CNA) Article #1
<br> **Title**: Soaring prices dampen consumer mood in India's festival season

```
url3 = 'https://www.channelnewsasia.com/business/india-rising-prices-deepavali-diwali-festival-2258601'
```
"""

article1 = 'NEW DELHI: For Delhi resident Suman Milind, rising prices in India are casting a long shadow this year over the upcoming Diwali festival of lights. The 33-year-old homemaker is tightening her purse strings and altering her spending habits, thanks to soaring costs of fuel, transport and many manufactured items, coupled with stagnant incomes due to the COVID-19 pandemic. "Earlier we used to get four or five boxes of dry fruits during festivals, but now we hardly get one or two. Because of the high prices," said Milind, adding that her family has reduced spending on food too by cutting back on meat to just once a week compared to several times a week earlier. Millions of Indian households are facing similar strains on their budgets ahead of Diwali, which this year falls in early November and marks the country\'s busiest shopping season for consumer goods. Many are foregoing big-ticket purchases such as television sets and jewellery this festive season, according to half a dozen people Reuters spoke to and a consumer survey by Mumbai-based consultancy Axis My India, threatening to slow an economy recovering strongly from the worst of COVID-19. Pump prices of petrol and diesel are up nearly 35 per cent from a year ago and cooking gas by more than 50 per cent, severely hitting more than three-quarters of households, economists said. "The sky-rocketing prices of petrol, cooking gas are unbearable when our earnings are still down by nearly 30 per cent from the pre-pandemic period," said Sultan Singh Tomar, 53, who supplies incense sticks and kitchenware to shops in New Delhi on his scooter. He said his petrol bill was up by 600 rupees (US$8) from a year ago and refilling the cooking gas cylinder was costlier by 400 rupees. Tomar is among millions of people working in the informal sector who dipped into savings during the pandemic and are now forced to pare back household spending.For months India\'s consumer-price-based inflation stayed above the central-bank\'s comfort level of 6 per cent driven by a rise in food prices.In September the consumer price index eased to 4.35 per cent, helped by a softening of food prices which make up nearly half of the index. Economists said that painted a better picture than what households are actually facing.According to an October report by Axis My India on consumer spending trends, more than 88 per cent of respondents in a survey said they will not be buying air conditioners, televisions, washing machines or jewellery this festival season and nearly half said they will make low-ticket purchases such as clothes. There is not much that Prime Minister Narendra Modi\'s government can do to alleviate the pain as global crude oil prices hit a three-year high at US$85 a barrel, piling up the pressure on a country that imports 80 per cent of its oil.Bidisha Ganguly, chief economist at industry chamber, Confederation of Indian Industries, said federal and state governments should cut fuel taxes, the highest among the major economies, as higher fuel prices posed a risk of building up of medium term inflationary pressures."(Otherwise) corporate earnings will be impacted in sectors where producers are unable to pass on the cost increases," she said, adding global shortages were already driving up commodity costs for many products.REDUCED FOOTFALLS Private economists have warned that annual wholesale-price-based inflation - a proxy for producers\' prices - staying in double digits for sixth months in a row could further fuel inflationary pressures as companies pass on rising costs to consumers.Already some retailers said rising raw material costs were impacting their sales."Our sales are not even half of what we used to have during the festival period," said Kawaljit Singh, who sells utensils from a shop in Chandani Chowk in the old quarter of Delhi.He said a rise in prices of metals like steel and copper had pushed up prices of utensils, cookers, festival lighting and gift items by 15 per cent to 20 per cent in the last four to five months.Because of rising prices and other market uncertainties, Delhi-based company auditor Lalit Vats said his family had downgraded to non-branded products and visited the wholesale markets to hunt for bargains. \"Government can talk about easing of inflation, but people know that costs of every item has gone up,\" lamented his mother Anita Vats.Source: Reuters/ng'

sentences = sent_tokenize(article1)
for sent in sentences:
  print(sent)

# Number of sentences in article
print('No. of sentences in this article: ',article_sentlength(article1))
# Number of words in article
print('No. of words in this article: ',article_wordlength(article1))

print('Average number of words in a sentence: ',avg_wordcount(article1))

print('Average word length in each sentence: ')
avg_sent_word(article1)

print('No. of stopwords in each sentence: ')
calc_stopwords(article1)

print('No. of numerical words in each sentence: ')
find_digs(article1)

"""In news articles, fully capitalised words are usually found as titles, subheadings or abbreviations
<br> Words that have been capitalised are most likely to be proper nouns, apart from sentence beginnings
"""

print('Capitalised / Uppercase words')
uppercase(article1)

"""### Channel News Asia (CNA) Article #2
<br> **Title**: Thailand PM announces quarantine-free travel for visitors from 45 countries

```
url4 = 'https://www.channelnewsasia.com/asia/thailand-pm-announces-quarantine-free-travel-visitors-45-countries-2259711'
```
"""

article2 = ('BANGKOK: Travellers from 45 low-risk countries who are fully vaccinated against COVID-19 will be able to visit Thailand without quarantine requirements from Nov 1 if they enter the country by air and test negative for the coronavirus.The announcement was made on Thursday (Oct 21) by Prime Minister Prayut Chan-o-cha on his Facebook page. “We need to move faster and do it now because by waiting for everything to be perfect first, we could be too late,” said Prayut.“Moreover, tourists may decide to travel to other countries instead.”Initially, Thailand only planned to allow travellers from about 10 "low-risk" countries, including Singapore, China and the United States to enter by air without quarantine requirements if they are fully vaccinated against COVID-19 and test negative for the virus before and after their flight.The list, which consists of 45 countries and Hong Kong, was issued by Thani Thongphakdi, permanent secretary at the foreign ministry.According to the foreign ministry, travellers must have resided in the eligible countries and territories for at least 21 consecutive days and will need to take a reverse transcriptase-polymerase chain reaction (RT-PCR) test within 72 hours of travelling to Thailand.Upon their arrival in Thailand, they also need to take an RT-PCR test and wait for the result at an approved hotel for one night or until they receive a negative test result. Medical insurance with a minimum coverage of US$50,000 is also compulsory.Visitors from these countries can visit Thailand quarantine-free from Nov 1 Australia'
'Austria '
'Bahrain '
'Belgium '
'Bhutan '
'Brunei Darusssalam '
'Bulgaria '
'Cambodia '
'Canada '
'Chile '
'China '
'Cyprus '
'Czech Republic '
'Denmark '
'Estonia '
'Finland '
'France '
'Germany '
'Greece '
'Hungary '
'Iceland '
'Ireland '
'Israel '
'Italy '
'Japan '
'Latvia '
'Lithuania '
'Malaysia '
'Malta '
'Netherlands '
'New Zealand '
'Norway '
'Poland '
'Portugal '
'Qatar '
'Saudi Arabia '
'Singapore '
'Slovenia '
'South Korea '
'Spain '
'Sweden '
'Switzerland '
'United Arab Emirates '
'United Kingdom '
'United States ')

sentences = sent_tokenize(article2)
for sent in sentences:
  print(sent)

# Number of sentences in article
print('No. of sentences in this article: ',article_sentlength(article2))
# Number of words in article
print('No. of words in this article: ',article_wordlength(article2))

print('Average number of words in a sentence: ',avg_wordcount(article2))

print('Average word length in each sentence: ')
avg_sent_word(article2)

print('No. of stopwords in each sentence: ')
calc_stopwords(article2)

print('No. of numerical words in each sentence: ')
find_digs(article2)

"""In news articles, fully capitalised words are usually found as titles, subheadings or abbreviations
<br> Words that have been capitalised are most likely to be proper nouns, apart from sentence beginnings
"""

print('Capitalised / Uppercase words')
uppercase(article2)